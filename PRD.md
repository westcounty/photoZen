# PhotoZen 图禅 - 产品功能说明文档

> 📅 文档版本: v1.6.0 | 更新日期: 2026-01-18

## 1. 产品概述

### 1.1 产品定位
PhotoZen（图禅）是一款专为摄影爱好者设计的 **照片整理神器**。通过 Tinder 风格的滑动操作、游戏化的连击系统和沉浸式的一站式整理流程，让繁琐的照片管理变成一种享受。

### 1.2 核心价值
- **高效**：滑动操作 + 批量处理，快速筛选海量照片
- **有趣**：连击系统 + 成就徽章，整理照片像玩游戏
- **安全**：无损编辑 + 回收站机制，操作可撤销
- **直观**：时间线浏览 + 多维度筛选，照片一目了然

---

## 2. 功能模块详解

### 2.1 滑动整理 (Flow Sorter)

**核心交互**：
| 滑动方向 | 操作 | 照片状态 |
|:------:|:----:|:-------:|
| ← 左滑 | 保留 | KEEP |
| → 右滑 | 保留 | KEEP |
| ↑ 上滑 | 删除 | TRASH |
| ↓ 下滑 | 待定 | MAYBE |

**两种视图模式**：
1. **卡片模式**：单张照片全屏显示，Spring 动画 + 触感反馈
2. **列表模式**：瀑布流网格（1-4列可切换），支持多选批量操作

**相册分类功能**（可选开启）：
- 卡片底部显示"我的相册"标签
- 点击标签自动将照片复制/移动到对应相册
- 滑动时同步分类，无需额外操作

**连击系统**：
- 快速滑动（间隔 < 1.5秒）累积连击数
- 连击越高，视觉反馈越强烈
- 颜色变化：白色 → 橙色 → 红色/火焰
- 震动反馈强度随连击递增

---

### 2.2 照片对比 (Light Table)

**功能特点**：
- 同屏对比 2-6 张照片
- **同步缩放**：放大一张，其他照片同步放大到相同区域
- 长按查看单张大图
- 快速做出取舍决策

**使用场景**：
- 一站式整理的"对比待定"阶段
- 从系统分享入口对比照片
- 手动从待定列表进入

---

### 2.3 时间线浏览 (Timeline)

**分组模式**：
| 模式 | 说明 |
|:----:|:-----|
| 智能分组 | 基于 4 小时时间间隔 + 地点变化自动识别事件 |
| 按天 | 按拍摄日期分组 |
| 按月 | 按月份分组 |
| 按年 | 按年份分组 |

**交互功能**：
- 每个分组显示"已整理 / 总数"进度
- 点击分组展开预览缩略图
- 一键进入该时间段的整理流程
- 正序/倒序切换
- 年月快速导航跳转

**全屏预览**：
- 点击照片进入全屏预览
- 支持双指缩放
- 循环切换同组照片
- 底部操作栏：添加到相册、删除、标记状态

---

### 2.4 一站式整理 (Workflow)

**动态阶段流程**：

```
┌─────────────────────────────────────────────────────────────┐
│                    是否开启"直接分类到相册"?                   │
├─────────────────────────────────────────────────────────────┤
│   是 (3阶段模式)        │        否 (4阶段模式)               │
│   ↓                    │        ↓                          │
│   筛选照片              │        筛选照片                     │
│   ↓                    │        ↓                          │
│   对比待定              │        对比待定                     │
│   ↓                    │        ↓                          │
│   清理回收站            │        分类到相册                   │
│   ↓                    │        ↓                          │
│   🎉 胜利               │        清理回收站                   │
│                        │        ↓                          │
│                        │        🎉 胜利                      │
└─────────────────────────────────────────────────────────────┘
```

**各阶段说明**：
1. **筛选阶段**：滑动整理未筛选照片
2. **对比待定阶段**：对比本次标记为"待定"的照片，做最终决定
3. **分类到相册阶段**：逐张将"保留"照片分配到相册（仅当未开启直接分类时）
4. **清理回收站阶段**：批量选择回收站照片，恢复或永久删除
5. **胜利页面**：展示本次整理统计（整理数、保留数、删除数、耗时、最大连击等）

**智能跳过**：无照片的阶段自动跳过

---

### 2.5 每日任务

**功能特点**：
- 可设置每日整理目标（默认 100 张）
- 支持"快速整理"和"一站式整理"两种模式
- 首页显示今日进度卡片
- 桌面小组件实时显示进度

**状态栏进度通知**：
- 常驻通知显示"已整理 / 目标"进度
- 完成目标后显示庆祝标题
- 点击通知直接进入 App
- 可在设置中关闭

---

### 2.6 相册管理

**我的相册**：
- 添加系统相册或创建自定义相册
- 气泡视图和列表视图切换
- 拖动手柄调整相册顺序
- 设置默认操作：复制到相册 / 移动到相册

**相册照片列表**：
- 按状态筛选（保留/待定/回收站/未筛选）
- 长按照片"从此张开始筛选"
- 多选后批量操作

---

### 2.7 照片状态与操作

**四种状态**：
| 状态 | 含义 | 角标颜色 |
|:----:|:-----|:-------:|
| UNSORTED | 未筛选 | 灰色/无 |
| KEEP | 保留 | 绿色 ✓ |
| MAYBE | 待定 | 黄色 ? |
| TRASH | 回收站 | 红色 ✗ |

**批量操作**：
- 长按进入多选模式
- 拖动批量选择（类似 Google Photos）
- 支持操作：标记状态、添加到相册、删除、分享

---

### 2.8 系统分享功能

**接收分享**：
- 从其他 App 分享照片到 PhotoZen
- 支持单张和多张照片

**操作选项**：
| 功能 | 说明 |
|:----:|:-----|
| 复制照片 | 将分享的照片复制到指定相册，保留 EXIF |
| 对比照片 | 2-6 张照片直接进入对比模式 |

---

### 2.9 成就系统

**成就分类**：
- 整理成就（整理照片数量里程碑）
- 连击成就（最高连击记录）
- 坚持成就（连续活跃天数）
- 效率成就（单日整理超 100 张）
- 探索成就（使用各种功能）

**稀有度等级**：
普通 → 稀有 → 史诗 → 传说 → 神话

**50+ 成就徽章**，解锁时弹出庆祝动画

---

### 2.10 无损编辑

**裁切功能**：
- 只保存裁切参数，不修改原图
- 支持任意比例和常用比例预设
- 导出时才真正处理

**虚拟副本**：
- 一张照片可创建多个虚拟副本
- 每个副本独立的裁切参数
- 方便保留同一照片的多种构图

---

### 2.11 其他功能

**智能筛选**：
- 按相册筛选
- 按日期范围筛选
- 自定义筛选组合

**回收站管理**：
- 删除的照片进入回收站
- 可恢复或永久删除
- 外部删除同步检测

**主题模式**：
- 深色模式
- 浅色模式
- 跟随系统

**滑动灵敏度**：
- 0.5（很灵敏）到 1.5（不灵敏）可调

---

## 3. 用户使用流程

### 3.1 首次使用
1. 授权照片权限
2. App 自动扫描并同步照片到本地数据库
3. 显示快速入门引导
4. 进入首页开始整理

### 3.2 日常使用
1. **方式一**：点击"每日任务"卡片，按目标整理
2. **方式二**：点击"时间线"，按时间维度整理
3. **方式三**：进入"相册"，按相册整理
4. **方式四**：直接进入"快速整理"自由整理

### 3.3 照片管理
- 在"保留"列表查看已保留照片，可快速分类到相册
- 在"待定"列表对比纠结的照片
- 在"回收站"最终决定是否永久删除

---

## 4. 设置选项

| 设置项 | 说明 | 默认值 |
|:------|:-----|:------:|
| 每日任务目标 | 1-1000 张 | 100 |
| 任务模式 | 快速整理 / 一站式整理 | 快速整理 |
| 状态栏进度通知 | 是否显示常驻通知 | 开启 |
| 直接分类到相册 | 滑动时显示相册标签 | 关闭 |
| 相册操作方式 | 复制 / 移动 | 移动 |
| 相册标签大小 | 0.8x - 1.2x | 1.0x |
| 滑动灵敏度 | 0.5 - 1.5 | 1.0 |
| 主题模式 | 深色/浅色/跟随系统 | 深色 |
| 实验性功能 | 启用 AI 功能入口 | 关闭 |

---

## 5. 版本规划

### 当前版本 v1.6.0 核心功能
- ✅ 滑动整理（卡片/列表模式）
- ✅ 照片对比（同步缩放）
- ✅ 时间线浏览（全屏预览）
- ✅ 一站式整理（动态多阶段）
- ✅ 相册分类（气泡图/列表）
- ✅ 成就系统（50+ 徽章）
- ✅ 每日任务（桌面小组件）
- ✅ 系统分享（复制/对比）
- ✅ 拖动批量选择

### 实验性功能（explore 分支）
- 🔬 智能画廊（AI 标签识别）
- 🔬 人脸聚类
- 🔬 相似照片检测
- 🔬 地图视图

---

## 6. AI 辅助开发指南

### 快速了解项目
1. 阅读本文档了解功能需求
2. 阅读 `TECH_DESIGN.md` 了解技术实现
3. 查看 `CHANGELOG.md` 了解版本演进
4. 查看 `Screen.kt` 了解导航结构

### 代码修改建议
- 修改 UI：先找到对应的 `*Screen.kt` 文件
- 修改业务逻辑：找到对应的 `*ViewModel.kt` 文件
- 修改数据层：查看 `data/` 目录下的 entity、dao、repository
- 添加新功能：参考现有的 Screen/ViewModel/UseCase 结构
